## Alternatives to the sigmoid activation

- So far, we have been using the sigmoid activation function in all the nodes in the hidden layers and in the output layer. We did that because we were building up neural networks by taking logistic regression and creating a lot of logistic regression units and string them together.
- But there are other neural networks which can be used to make our neural network much more powerful
- Let's go back to the demand prediction example where price, shipping cost, marketing, material were given and we would try to predict if something is highly affordable. If there's good awareness and high perceived quaity and based on that we try to predict if it was a top seller.
- But this assumes that awareness is maybe binary and people either are aware or they are not. However, it seems that the degree to which possible buyers are aware of the t shirt we are selling may not be binary, they can be a little bit aware, somewhat aware, extremely aware or it could have gone completely viral.
- So rather than modeling awareness as a binary number 0, 1 that we try to estimate the probability of awareness or rather than modeling awareness is just a number between 0 and 1. Maybe awareness should be any non negative number because there can be any non negative value of awareness going from 0 up to really large numbers.
- So whereas previously we had used this equation to calculate the activation of that 2nd hidden unit estimating awareness where g was the sigmoid function and just goes between 0 and 1. If we want the activation function to potentially take on much larger positive values, we can instead swap in a different activation function. It turns out to be a really common choice of activation function in neural networks.
- It goes if z < 0, then g(z) is to the left and then there's this straight line 45 degree to the right of 0. And so when z >= 0, g(z) is just equal to z. The mathematical function for this g(z) = max(0,z)
- This reactivation function goes by the name ReLU and it stands for Rectified Linear Unit.

<img width="1913" height="923" alt="image" src="https://github.com/user-attachments/assets/b2cdf17c-299e-4d29-b7f9-c227980a67a2" />

- We are seeing three differenct activation functions, the sigmoid, ReLU and the linear activation function. Linear activation function is also said to be no activation function

<img width="1893" height="911" alt="image" src="https://github.com/user-attachments/assets/5931bbb7-8bab-4bd4-86a1-ea19bfeee989" />

---

## Choosing activation functions

- We are going to look at how we can choose the activation function for different neurons in the neural network. We will start with the output layer.
- It depends on what the target label or the ground truth label y is. We can choose different activation functions for differenet neurons in the neural network, and when considering the activation function for the output layer, it turns out that there'll  often be one fairly natural choice, depending on what is the target or the gorund truth label y.
- Specifically, if we are working on a classification problem where y is either 0 or 1, so a binary classification problem, then the sigmoid activation function will almost always be the most natural choice, because then the neural network learns to predict the probability that y = 1, just like we had for logistic regression. It is recommended to use a sigmoid function while working on a binary classification problem.
- Alternatively, if we are solving a regression problem, then we might choose a different activation function. In case when the output label y is probable to be a number and can be between a negative and a positive number, in that case, it's best to use the linear activation function.
- Finally, if y can only take on non-negative values, such as if we are predicting the price of the house, that can never be negative, then the most natural choice will be the ReLU activation function because this activation function only takes on non-negative values, either 0 or positive values.

<img width="1913" height="930" alt="image" src="https://github.com/user-attachments/assets/33f3fb0a-9694-43be-aced-6306b18113d5" />

- In case of the hidden layers of a neural network, it turns out that the ReLU activation function is by far the most common choice in modern neural network training.
- Initially, sigmoid function was used quite often but now, ReLU function is the one which used more
- The one exception that we do use a sigmoid activation function in the output layer if we have a binary classification problem.
- If we compare the ReLU and the sigmoid activaion functions, the ReLU is a bit faster to compute because it just requires computing max of 0,z, whereas the sigmoid requires taking an exponentiation and then an inverse and so on, and hence it is a little bit less efficient.
- The 2nd reason which turns out to be even more important is that the ReLU function goes flat only in one part of the graph; here on the left is completely flat, whereas the sigmoid activation function, it goes flat in two places. It goes flat to the left of the graph and it goes flat to the right of the graph
- If we are using a gradient descent to train a neural network, then when we have a function that is flat in a lot of places, gradient descent would be really slow.
- The gradient descent optimizes the cost function J of W,B rather than optimizes the activation function, but the activation function is a piece of what goes into computing, and that results in more places in the cost function J of W,B that are flats as well and with a small gradient and it slows down learning.
- Researchers have found that using the ReLU activation function can cause the neural network to learn a bit faster as well, which is why ReLU activation function is the most common choice

<img width="1913" height="918" alt="image" src="https://github.com/user-attachments/assets/f48312a5-0cbd-496e-87c1-b19e6715e365" />

- To summarize, for the output layer, use a sigmoid function, if we have a binary classification problem. Linear if y is a number that can take on positive and negative values or use ReLU if y can take on only positive values or zero positive values or non-negative values.
- Then for the hidden layers, I would recommend just using ReLU as a default activation function.

<img width="1901" height="930" alt="image" src="https://github.com/user-attachments/assets/f3cca131-5ce5-4707-8746-aa9188e20338" />

- There are also some other activation functions such as the tan h activation function or the LeakyReLU activation function or the swish activation function. 

---

## Why do we need activation functions?

- Let's take a look at why neural networks need activation functions and why they just don't work if we were to use the linear activation function in every neuron in the neural network.
- It turns out that this big neural network will become no different than just linear regression. So this would defeat the entire purpose of using a neural network because it would then just not be able to fit anything more complex than the linear regression model that we learned before.

<img width="1894" height="930" alt="image" src="https://github.com/user-attachments/assets/99debd3e-0fe2-4c3a-aea3-a30ee22d8c79" />

- In linear algebra, the result comes from the fact that a linear function of a linear function is itself a linear function. This is why having multiple layers in a neural network doesn't let the neural network compute any more complex features or learn anything more complex than just a linear function.

<img width="1888" height="905" alt="image" src="https://github.com/user-attachments/assets/296773c2-0ced-41bc-b964-ba46543ce839" />

- In case, if we had a neural network with multiple layers like this and say we were to use a linear activation function for all of the hidden layers and also use a linear function for the output layer, then it turns out this model will compute an output that is completely equivalent to linear regression.
- The output a4 can be expressed as a linear function of the input features x plus b. Or alternatively, if we were to still use a linear activation function for the hidden layers but we were to use a logistic activation function for the output layer, then this model can be equivalent to logistic regression and a4 can be expressed as shown in the diagram.
- So a common rule is that, don't use the linear activation function in the hidden layers of the neural network. In fact, ReLU function for hidden layers should do just fine.

<img width="1879" height="925" alt="image" src="https://github.com/user-attachments/assets/093440e0-c16b-4b46-bb60-0b9f67be730a" />

---

## Optional Lab - ReLU activation

```
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.gridspec import GridSpec
plt.style.use('./deeplearning.mplstyle')
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, LeakyReLU
from tensorflow.keras.activations import linear, relu, sigmoid
%matplotlib widget
from matplotlib.widgets import Slider
from lab_utils_common import dlc
from autils import plt_act_trio
from lab_utils_relu import *
import warnings
warnings.simplefilter(action='ignore', category=UserWarning)

```

- Importing the required libraries
  
<img width="1155" height="653" alt="image" src="https://github.com/user-attachments/assets/b002ecf5-6fbb-44af-8d3f-472ca3a5e1c5" />

<img width="1139" height="619" alt="image" src="https://github.com/user-attachments/assets/154c2b97-e4a6-45b5-b13f-db8ed2df383e" />

<img width="1106" height="594" alt="image" src="https://github.com/user-attachments/assets/e9c63ef5-27e4-4f88-a1d1-984dd975cbde" />

<img width="1156" height="522" alt="image" src="https://github.com/user-attachments/assets/385b7920-2b55-4277-b63d-9985a4f3672e" />

